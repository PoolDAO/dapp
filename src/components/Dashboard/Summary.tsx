import React, { useEffect, useCallback } from 'react'
import './summary.css'

import Pooldao from '../../service/Pooldao'
import useApp, { useAppApi } from '../../service/useApp'
import Amount from '../../components/Amount'

const Summary: React.FC = () => {
  const provider = useApp(state => state.provider)
  const currentAccount = useApp(state => state.currentAccount)
  const ethBalance = useApp(state => state.ethBalance)
  const poolBalance = useApp(state => state.poolBalance)

  const getEthBalance = useCallback(async () => {
    const [ethBalance, poolBalance] = await Promise.all([
      provider?.getEthBalance(currentAccount),
      provider?.getPoolEthBalance(currentAccount),
    ])

    useAppApi.setState(state => {
      state.ethBalance = ethBalance
      state.poolBalance = poolBalance
    })
  }, [provider, useAppApi, currentAccount])

  useEffect(() => {
    getEthBalance()
  }, [getEthBalance])

  return (
    <div className="summary">
      <div className="summary-block">
        <svg width="50px" height="51px" viewBox="0 0 50 51">
          <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
            <path
              d="M23.6184928,0.825169953 L23.7093219,0.961918746 L29.852,11.074 L36,11.0742019 C40.418278,11.0742019 44,14.6559239 44,19.0742019 L44,21.0742019 L44.00016,21.144552 C46.3912772,22.5278125 48,25.1131385 48,28.0742019 L48.0009007,30.2452261 C49.1656226,30.6573168 50,31.7683197 50,33.0742019 L50,37.0742019 C50,38.3800841 49.1656226,39.4910871 48.0009007,39.9031777 L48,42.0742019 C48,46.4924799 44.418278,50.0742019 40,50.0742019 L8,50.0742019 C3.581722,50.0742019 0,46.4924799 0,42.0742019 L0,19.0742019 C0,14.6559239 3.581722,11.0742019 8,11.0742019 L14.147,11.074 L20.2906781,0.961918746 C20.4239502,0.742532365 20.5978851,0.551374658 20.8025354,0.398392886 L20.9616269,0.290969971 L21.10526,0.211473584 C21.9785215,-0.226525862 23.0453807,0.0339862673 23.6184928,0.825169953 Z M40,22.0742019 L2.08292784,22.0740195 C2.08298315,22.0743493 2.0830385,22.074679 2.08309386,22.0750088 L2,22.075 L2,42.0742019 C2,45.3125988 4.56557489,47.9517737 7.77506174,48.0700634 L8,48.0742019 L40,48.0742019 C43.2383969,48.0742019 45.8775718,45.508627 45.9958615,42.2991402 L46,42.0742019 L46,40.074 L39,40.0742019 C36.2385763,40.0742019 34,37.8356257 34,35.0742019 C34,32.3127782 36.2385763,30.0742019 39,30.0742019 L46,30.074 L46,28.0742019 C46,24.835805 43.4344251,22.1966301 40.2249383,22.0783404 L40,22.0742019 Z M47,32.0742019 L39,32.0742019 C37.3431458,32.0742019 36,33.4173477 36,35.0742019 C36,36.6718828 37.24892,37.9778628 38.8237272,38.0691092 L39,38.0742019 L47,38.0742019 C47.5128358,38.0742019 47.9355072,37.6881617 47.9932723,37.190823 L48,37.0742019 L48,33.0742019 C48,32.5613661 47.6139598,32.1386947 47.1166211,32.0809296 L47,32.0742019 Z M42,34.0742019 C42.5522847,34.0742019 43,34.5219172 43,35.0742019 C43,35.6264867 42.5522847,36.0742019 42,36.0742019 C41.4477153,36.0742019 41,35.6264867 41,35.0742019 C41,34.5219172 41.4477153,34.0742019 42,34.0742019 Z M36,13.0742019 L31.067,13.074 L34.5001148,18.7252239 C34.75915,19.1516359 34.9486265,19.6064311 35.0690379,20.0742128 L40,20.0742019 C40.6907281,20.0742019 41.3610104,20.1617406 42.0003581,20.3263291 L42,19.0742019 C42,15.835805 39.4344251,13.1966301 36.2249383,13.0783404 L36,13.0742019 Z M12.932,13.074 L8,13.0742019 C4.76160306,13.0742019 2.12242824,15.6397768 2.00413847,18.8492636 L2,19.0742019 L2,20.074 L8.9309621,20.0742128 C9.02859295,19.6949304 9.17162818,19.3241854 9.36033094,18.970185 L9.49988524,18.7252239 L12.932,13.074 Z M22,13.3242019 L13,20.074 L31,20.074 L22,13.3242019 Z M22,2.00029185 L12.153,18.209 L21.4,11.2742019 L21.5104,11.2022019 C21.852,11.0102019 22.28,11.0342019 22.6,11.2742019 L22.6,11.2742019 L31.846,18.208 L22,2.00029185 Z"
              fill="#FFFFFF"
              fillRule="nonzero"
            ></path>
          </g>
        </svg>
        <p className="summary-label">ETH 余额</p>
        <p className="summary-amount">
          <Amount value={ethBalance} minDigits={8} />
          <span className="summary-amount-unit">ETH</span>
        </p>
        <a
          className="summary-conversion-btn"
          onClick={() => alert('兑换按钮')}
        />
      </div>
      <div className="summary-block">
        <svg width="50px" height="51px" viewBox="0 0 50 51">
          <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
            <path
              d="M23.5,0 C28.7467051,0 33,4.25329488 33,9.5 C33,10.0365 32.9555275,10.5626128 32.8700679,11.0748531 L36,11.0742019 C40.418278,11.0742019 44,14.6559239 44,19.0742019 L44.00016,21.144552 C46.3912772,22.5278125 48,25.1131385 48,28.0742019 L48.0009007,30.2452261 C49.1656226,30.6573168 50,31.7683197 50,33.0742019 L50,37.0742019 C50,38.3800841 49.1656226,39.4910871 48.0009007,39.9031777 L48,42.0742019 C48,46.4924799 44.418278,50.0742019 40,50.0742019 L8,50.0742019 C3.581722,50.0742019 0,46.4924799 0,42.0742019 L0,19.0742019 C0,14.6559239 3.581722,11.0742019 8,11.0742019 L13,11.074 L13,0 L23.5,0 Z M40,22.0742019 L2,22.0742019 L2,42.0742019 C2,45.3125988 4.56557489,47.9517737 7.77506174,48.0700634 L8,48.0742019 L40,48.0742019 C43.2383969,48.0742019 45.8775718,45.508627 45.9958615,42.2991402 L46,42.0742019 L46,40.0741459 L39,40.0742019 C36.2385763,40.0742019 34,37.8356257 34,35.0742019 C34,32.3127782 36.2385763,30.0742019 39,30.0742019 L46,30.0741459 L46,28.0742019 C46,24.835805 43.4344251,22.1966301 40.2249383,22.0783404 L40,22.0742019 Z M47,32.0742019 L39,32.0742019 C37.3431458,32.0742019 36,33.4173477 36,35.0742019 C36,36.6718828 37.24892,37.9778628 38.8237272,38.0691092 L39,38.0742019 L47,38.0742019 C47.5128358,38.0742019 47.9355072,37.6881617 47.9932723,37.190823 L48,37.0742019 L48,33.0742019 C48,32.5613661 47.6139598,32.1386947 47.1166211,32.0809296 L47,32.0742019 Z M42,34.0742019 C42.5522847,34.0742019 43,34.5219172 43,35.0742019 C43,35.6264867 42.5522847,36.0742019 42,36.0742019 C41.4477153,36.0742019 41,35.6264867 41,35.0742019 C41,34.5219172 41.4477153,34.0742019 42,34.0742019 Z M36,13.0742019 L32.304428,13.0748775 C30.89206,16.549868 27.4821595,19 23.5,19 L20,19 L20,20.074 L40,20.0742019 C40.6907281,20.0742019 41.3610104,20.1617406 42.0003581,20.3263291 L42,19.0742019 C42,15.835805 39.4344251,13.1966301 36.2249383,13.0783404 L36,13.0742019 Z M18,20.074 L18,2 L15,2 L15,20.074 L18,20.074 Z M13,13.074 L8,13.0742019 C4.76160306,13.0742019 2.12242824,15.6397768 2.00413847,18.8492636 L2,19.0742019 L2,20.0741459 L13,20.074 L13,13.074 Z M23.5,2 L20,2 L20,17 L23.5,17 C27.6421356,17 31,13.6421356 31,9.5 C31,5.43908272 27.7725256,2.13198248 23.7427311,2.00385357 L23.5,2 Z"
              fill="#FFFFFF"
              fillRule="nonzero"
            ></path>
          </g>
        </svg>
        <p className="summary-label">poolETH 余额</p>
        <p className="summary-amount">
          <Amount value={poolBalance} minDigits={8} />
          <span className="summary-amount-unit">poolETH</span>
        </p>
        <a
          className="summary-conversion-btn"
          style={{ backgroundColor: '#131313' }}
          onClick={() => alert('兑换按钮')}
        />
      </div>
      <div className="summary-block">
        <svg width="50px" height="50px" viewBox="0 0 50 50">
          <g stroke="none" strokeWidth="1" fill="none" fillRule="evenodd">
            <path
              d="M25,0 C38.8071187,0 50,11.1928813 50,25 C50,38.8071187 38.8071187,50 25,50 C11.1928813,50 0,38.8071187 0,25 C0,11.1928813 11.1928813,0 25,0 Z M25,2 C12.2974508,2 2,12.2974508 2,25 C2,37.7025492 12.2974508,48 25,48 C37.7025492,48 48,37.7025492 48,25 C48,12.2974508 37.7025492,2 25,2 Z M20.6943101,43.5102768 C21.9232133,43.7949341 23.1841529,43.9571903 24.4642146,43.9925988 L24.4089127,45.991834 C22.9952529,45.9527301 21.6016533,45.7734033 20.2429892,45.4586888 L20.6943101,43.5102768 Z M31.1017943,42.9992996 L31.7437046,44.8934884 C30.4193598,45.3422877 29.0492226,45.6580633 27.6493454,45.8343714 L27.399429,43.8500474 C28.6656086,43.6905779 29.9044356,43.4050654 31.1017943,42.9992996 Z M14.5755057,40.8875895 C15.6360299,41.5849281 16.763943,42.174617 17.9433185,42.6466831 L17.2001084,44.5034649 C15.8959386,43.9814477 14.648926,43.3294918 13.4766848,42.5586946 L14.5755057,40.8875895 Z M36.9466228,39.7750998 L38.2051135,41.3295133 C37.114622,42.2124015 35.9383953,42.9846286 34.6939307,43.6333188 L33.769466,41.8598011 C34.8953139,41.2729411 35.9596721,40.574159 36.9466228,39.7750998 Z M9.74010245,36.3217965 C10.4975345,37.340928 11.3553967,38.2826148 12.2997141,39.1318579 L10.9623436,40.6189492 C9.91924497,39.68087 8.97164804,38.6406803 8.1348884,37.5148128 L9.74010245,36.3217965 Z M25,10 L34.6462612,25.4822492 C34.8365586,25.7876766 34.8464755,26.1683071 34.6806729,26.4802126 L34.6102692,26.5936745 L25,40 L15.3897308,26.5936745 C15.1800711,26.3011992 15.1455484,25.9220078 15.2908235,25.6000285 L15.3537388,25.4822492 L25,10 Z M41.2930075,34.7801979 L43.0067605,35.8112413 C42.283529,37.0133636 41.4413141,38.1404742 40.4940078,39.1753611 L39.0187483,37.8249502 C39.8762552,36.8881649 40.6385443,35.8680165 41.2930075,34.7801979 Z M31.645,27.295 L25,30.618034 L18.354,27.295 L25,36.566 L31.645,27.295 Z M6.78375319,30.4191986 C7.14582058,31.6381916 7.62958301,32.8147536 8.22663917,33.9333352 L6.46224732,34.8751002 C5.80204539,33.6382154 5.2670104,32.336953 4.86653621,30.9886536 L6.78375319,30.4191986 Z M43.6636548,28.5787585 L45.6283099,28.9530982 C45.3646021,30.3371212 44.9628198,31.6848796 44.4305142,32.979718 L42.5807241,32.2192729 C43.0619878,31.0485945 43.4252148,29.8301681 43.6636548,28.5787585 Z M25,23.3426068 L19.96,25.861 L25,28.381 L30.038,25.861 L25,23.3426068 Z M4.04671688,23.588611 L6.0423213,23.7211365 C6.01379871,24.1506372 6.00000306,24.5774198 6.00005146,25.0436727 C6.00195397,25.8912956 6.05931315,26.7316598 6.17103689,27.5612327 L4.18893152,27.8281751 C4.06549964,26.9116668 4.00215642,25.9836311 4.00005146,25.0460236 C3.99999853,24.5338607 4.01522439,24.0628333 4.04671688,23.588611 Z M45.7225024,21.5784713 C45.9038247,22.6845965 45.9970212,23.8092834 45.9999337,24.947465 C46.0000011,25.2667844 45.9949977,25.5410351 45.9842488,25.8205585 L43.9857259,25.7437066 C43.9954615,25.490535 43.9999957,25.2419967 43.9999363,24.9502389 C43.9973011,23.9211783 43.9129277,22.9029665 43.7488443,21.9020044 L45.7225024,21.5784713 Z M25,13.782 L18.372,24.419 L25,21.1055728 L31.627,24.419 L25,13.782 Z M5.80338805,16.4735855 L7.63077309,17.2863979 C7.11613626,18.4434172 6.71832472,19.6510562 6.44454252,20.8942967 L4.4913424,20.4641697 C4.79416086,19.0890759 5.23419759,17.7532537 5.80338805,16.4735855 Z M43.2491498,14.6022638 C43.9444207,15.8200384 44.516384,17.1054317 44.9551167,18.4409855 L43.0550144,19.0651738 C42.6583381,17.8576447 42.1411363,16.695319 41.5122948,15.5938962 L43.2491498,14.6022638 Z M9.9159065,10.3893604 L11.3523541,11.7809848 C10.4685152,12.6932914 9.67744723,13.6917007 8.99218845,14.7606729 L7.30844463,13.6813181 C8.06562702,12.5001484 8.93956286,11.3971513 9.9159065,10.3893604 Z M38.585599,8.98598525 C39.6548374,9.8939353 40.6315287,10.9067288 41.4999731,12.0082374 L39.9293981,13.2465 C39.1432408,12.2493618 38.2590186,11.3324555 37.2910494,10.5104987 L38.585599,8.98598525 Z M15.8378788,6.09901856 L16.7115189,7.89811637 C15.569315,8.45276946 14.4857266,9.12109874 13.4767194,9.89192658 L12.2625806,8.30262898 C13.3775548,7.45084799 14.5751792,6.71218425 15.8378788,6.09901856 Z M32.2384032,5.28112705 C33.5577193,5.76556243 34.8230527,6.38155636 36.0168298,7.11853831 L34.9662062,8.82035794 C33.8863319,8.15369419 32.74199,7.59660178 31.5490333,7.15856389 L32.2384032,5.28112705 Z M22.9455117,4.09929089 L23.1389086,6.08991834 C21.8675357,6.21343699 20.6210536,6.46337981 19.4132504,6.83436756 L18.82601,4.92252323 C20.1618228,4.51221618 21.5402362,4.23581868 22.9455117,4.09929089 Z M25,4 C26.4149467,4 27.812466,4.14008083 29.1780685,4.41583516 L28.7822012,6.37626601 C27.5467301,6.12678892 26.2818177,6 25,6 L25,4 Z"
              fill="#FFFFFF"
              fillRule="nonzero"
            ></path>
          </g>
        </svg>
        <p className="summary-label">已赚取</p>
        <p className="summary-amount summary-amount-positive">
          +34.67364834
          <span className="summary-amount-unit">poolETH</span>
        </p>
        <label className="summary-badge">年化收益约 12.23%</label>
      </div>
    </div>
  )
}

export default Summary
